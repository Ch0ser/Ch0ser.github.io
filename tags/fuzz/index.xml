<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Fuzz on Choser&#39;s Blog</title>
        <link>http://localhost:1313/tags/fuzz/</link>
        <description>Recent content in Fuzz on Choser&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>Ch0ser</copyright>
        <lastBuildDate>Mon, 13 Oct 2025 23:51:05 +0800</lastBuildDate><atom:link href="http://localhost:1313/tags/fuzz/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>DGF一览</title>
        <link>http://localhost:1313/p/dgf%E4%B8%80%E8%A7%88/</link>
        <pubDate>Mon, 13 Oct 2025 23:51:05 +0800</pubDate>
        
        <guid>http://localhost:1313/p/dgf%E4%B8%80%E8%A7%88/</guid>
        <description>&lt;img src="http://localhost:1313/images/EarlyMorningForest.png" alt="Featured image of post DGF一览" /&gt;&lt;h1 id=&#34;dgf一览&#34;&gt;DGF一览
&lt;/h1&gt;&lt;p&gt;定向灰盒测试相关技术 核心策略 时间顺序梳理·极简版&lt;/p&gt;
&lt;h2 id=&#34;aflamerican-fuzzy-lop-2014&#34;&gt;AFL(American Fuzzy Lop 2014)
&lt;/h2&gt;&lt;p&gt;传统灰盒：全图覆盖，无定向&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;变异策略&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;确定性：bit/byte flip（翻转）、整数加减、边界值、字典&lt;/li&gt;
&lt;li&gt;随机叠加（Havoc）：纯随机组合多种变异操作（如插入、删除、替换）&lt;/li&gt;
&lt;li&gt;拼接（Splicing）：将两个种子拼接后执行 havoc 变异&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;反馈引导策略&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;边覆盖率（Edge Coverage）：插桩追踪 CFG 边的命中情况，作为变异方向的反馈&lt;/li&gt;
&lt;li&gt;上下文敏感边覆盖：区分同一 CFG 边在不同调用上下文下的命中情况，提升精度&lt;/li&gt;
&lt;li&gt;路径覆盖（PathAFL）：记录完整路径哈希，避免路径碰撞&lt;/li&gt;
&lt;li&gt;Ngram 插桩：记录最近前 N 个分支的历史状态&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;aflgo-2017&#34;&gt;AFLGo （2017）
&lt;/h2&gt;&lt;p&gt;首次提出“定向”概念，距离制导。（DGF 的起点）&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;AFL（基于覆盖率引导）-&amp;gt;AFLGo（定向制导）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;距离度量（Distance Metric）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;静态阶段&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用 LLVM 生成调用图 CG + 过程间控制流图 ICFG。&lt;/li&gt;
&lt;li&gt;对每个基本块到目标块跑 &lt;strong&gt;Dijkstra&lt;/strong&gt;，算出最短路径长度 &lt;code&gt;distance(b)&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;一个种子到目标的距离取它所有覆盖块距离的 &lt;strong&gt;加权平均&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;距离越小，优先级越高；距离为 0 表示已命中目标。&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;多目标扩展：若同时定向 N 个目标，可维护 最小距离 或 平均距离 两种模式（&lt;code&gt;-m&lt;/code&gt; 选项）。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;能量调度（Power Schedule）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;AFLGo 把 AFL 的 &lt;code&gt;perf_score&lt;/code&gt; 公式改造成 &lt;strong&gt;Simulated Annealing (SA)&lt;/strong&gt; 形式，解决“过早收敛”与“局部最优”。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1.0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;20.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;progress_to_tx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;// 温度随时间衰减
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;double&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;normalized_d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 距离+时间双因子
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;perf_score&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;2.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;log2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MAX_FACTOR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;总结一下 模拟退火 ：早期系统鼓励探索，距离较远也给予能量（算力）；后期系统愈发挑剔，只给近距离种子变异机会。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;种子队列管理&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;主队列&lt;/strong&gt;（AFL ）：按覆盖率排队。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;优先队列&lt;/strong&gt;（AFLGo 新增）：按距离排序；每次 fuzz 80% 概率从优先队列取种子。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;变异策略&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;确定性阶段（固定套路）
&lt;ul&gt;
&lt;li&gt;与 AFL 相同（bit/byte flip, arith, interest, dictionary）。&lt;/li&gt;
&lt;li&gt;距离度量不会缩短确定性阶段，只是 &lt;strong&gt;打分&lt;/strong&gt;，保证兼容性。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Havoc / Splicing
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;距离越小的种子&lt;/strong&gt; 获得的 havoc 轮次越多（由 power_factor 决定）。&lt;/li&gt;
&lt;li&gt;对“已到达目标”的种子，AFLGo 会额外给 &lt;strong&gt;二次变异&lt;/strong&gt; 机会，以探索目标附近的新分支（patch 回归测试常用）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;windrangericse-2022&#34;&gt;WindRanger（ICSE 2022）
&lt;/h2&gt;&lt;p&gt;核心是用“走错路口”指路：Deviation Basic Block（DBB）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DBB 机制&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;静态找“一步错即永远到不了目标”的块&lt;/li&gt;
&lt;li&gt;动态过滤：仅保留种子真实触发者（它在执行时真的走错的路口）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;距离&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;仅累加 DBB 到目标的最短路径 × 难度系数（该系数青睐简单分支）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;调度&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Favored 队列（90 %）：按 DBB 距离排序&lt;/li&gt;
&lt;li&gt;Less-favored 队列（10 %）：保留全局探索&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;beaconieee-sp-2022&#34;&gt;Beacon（IEEE S&amp;amp;P 2022）
&lt;/h2&gt;&lt;p&gt;核心是 运行时剪枝：Weakest Precondition。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;核心&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;静态：推导 最小充分条件 WP，插入 &lt;code&gt;assert(WP)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;动态：断言失败立即退出路径&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;代价&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;复杂循环下 WP 爆炸，静态耗时显著&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;注意：与 DAFL 的“非侵入”不同，Beacon会 &lt;strong&gt;修改被测程序&lt;/strong&gt; 本体。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;参考资料&#34;&gt;参考资料
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;Böhme, M., Pham, V.-T., Nguyen, M.-D., and Roychoudhury, A. 2017. &lt;em&gt;Directed Greybox Fuzzing&lt;/em&gt;. In &lt;em&gt;Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security&lt;/em&gt; (CCS ’17). ACM, New York, NY, USA, 2329–2344. &lt;a class=&#34;link&#34; href=&#34;https://doi.org/10.1145/3133956.3134020&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://doi.org/10.1145/3133956.3134020&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Du, Z., Li, Y., Liu, Y., and Mao, B. 2022. &lt;em&gt;Windranger: A Directed Greybox Fuzzer Driven by Deviation Basic Blocks&lt;/em&gt;. In &lt;em&gt;Proceedings of the 44th International Conference on Software Engineering&lt;/em&gt; (ICSE ’22). ACM, New York, NY, USA, 2440–2451. &lt;a class=&#34;link&#34; href=&#34;https://doi.org/10.1145/3510003.3510197&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://doi.org/10.1145/3510003.3510197&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Huang, H., Guo, Y., Shi, Q., Yao, P., Wu, R., and Zhang, C. 2022. &lt;em&gt;Beacon: Directed Grey-box Fuzzing with Provable Path Pruning&lt;/em&gt;. In &lt;em&gt;Proceedings of the 2022 IEEE Symposium on Security and Privacy&lt;/em&gt; (SP ’22). IEEE, 36–50. &lt;a class=&#34;link&#34; href=&#34;https://doi.org/10.1109/SP46214.2022.9833709&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://doi.org/10.1109/SP46214.2022.9833709&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Zalewski, M. 2018. &lt;em&gt;American Fuzzy Lop (AFL)&lt;/em&gt;. GitHub repository, &lt;a class=&#34;link&#34; href=&#34;https://github.com/google/AFL&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://github.com/google/AFL&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        
    </channel>
</rss>
